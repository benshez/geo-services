Object.defineProperty(exports, "__esModule", { value: true });
// libs
var core_1 = require("@angular/core");
var router_1 = require("@angular/router");
// app
var models_1 = require("../../../../app/modules/core/services/api/models");
var index_1 = require("../../../../app/modules/core/index");
var nativescript_mapbox_1 = require("nativescript-mapbox");
var MapFeature = (function () {
    function MapFeature(id, place_name, center) {
        this.id = id;
        this.place_name = place_name;
        this.center = center;
    }
    return MapFeature;
}());
var NSMapComponent = (function () {
    function NSMapComponent(apiOptions, route, router, map) {
        this.apiOptions = apiOptions;
        this.route = route;
        this.router = router;
        this.map = map;
        this.loading = false;
        this.features = [];
        this.options = {
            accessToken: index_1.Config.ENVIRONMENT().MAP_BOX_API_KEY,
            map: null,
            options: {
                container: 'map',
                style: 'mapbox://styles/mapbox/light-v9',
                center: [152.994306, -26.612273],
                zoom: 1,
                hash: false,
                interactive: false
            }
        };
        this.marker = {
            id: 'marker',
            offset: [-25, -25],
            latLang: [0, 0],
            popup: {
                offset: 25,
                text: ''
            }
        };
        this.markers = [];
    }
    NSMapComponent.prototype.ngOnInit = function () {
        this.returnUrl = this.route.snapshot.queryParams[index_1.Config.ROUTE_PARAMETERS.LOGIN_RETURN_URL] || '/';
        this.options.options.center = [index_1.Config.ROUTE_PARAMETERS.LONGITUDE, index_1.Config.ROUTE_PARAMETERS.LATITUDE];
        this.onShow(this.options);
    };
    NSMapComponent.prototype.onShow = function (options) {
        var self = this;
        this.map.show({
            accessToken: options.accessToken,
            style: nativescript_mapbox_1.MapStyle.DARK,
            margins: {
                left: 10,
                right: 10,
                top: 65,
                bottom: 0
            },
            center: {
                lat: self.options.options.center[1],
                lng: self.options.options.center[0]
            },
            zoomLevel: 13,
            showUserLocation: true,
            hideAttribution: false,
            hideLogo: false,
            hideCompass: true,
            disableRotation: false,
            disableScroll: true,
            disableZoom: true,
        }).then(function (result) {
            self.onMapComponentInit(self.options);
        }, function (error) {
            console.log("mapbox show error: " + error);
        });
    };
    NSMapComponent.prototype.onMapComponentInit = function (options) {
        this.onSetCentre(options);
    };
    NSMapComponent.prototype.onSetCentre = function (options) {
        this.loading = true;
        this.map.setCenter({
            lat: options.options.center[1],
            lng: options.options.center[0],
            animated: false
        });
        this.onRemoveMarker();
        this.marker.latLang = this.options.options.center;
        this.marker.popup.text = 'testing';
        this.onAddMarkers(this.marker);
    };
    NSMapComponent.prototype.onRemoveMarker = function () {
        this.map.removeMarkers();
    };
    NSMapComponent.prototype.onAddMarkers = function (marker) {
        this.map.addMarkers([
            {
                id: marker.id,
                lat: marker.latLang[1],
                lng: marker.latLang[0],
                title: marker.popup.text,
                subtitle: 'Infamous subtitle!',
                icon: 'res://marker25_29',
                //icon: 'https://farm9.staticflickr.com/8571/15844010757_63b093d527_n.jpg', // from the internet (see the note at the bottom of this readme), or:
                iconPath: 'res://marker25_29',
                onTap: this.onTap,
                onCalloutTap: this.onCalloutTap
            }
        ]);
        this.loading = !this.loading;
    };
    NSMapComponent.prototype.onTap = function (marker) {
        console.log("Marker tapped with title: '" + marker.title + "'");
    };
    NSMapComponent.prototype.onCalloutTap = function (marker) {
        console.log("Marker callout tapped with title: '" + marker.title + "'");
    };
    return NSMapComponent;
}());
NSMapComponent = __decorate([
    core_1.Component({
        moduleId: module.id,
        selector: 'sd-map',
        templateUrl: index_1.Config.COMPONENT_ITEMS.TEMPLATE,
        styleUrls: [index_1.Config.COMPONENT_ITEMS.CSS],
        changeDetection: core_1.ChangeDetectionStrategy.OnPush,
        providers: [nativescript_mapbox_1.Mapbox]
    }),
    __metadata("design:paramtypes", [models_1.ApiServiceParametersOptions,
        router_1.ActivatedRoute,
        router_1.Router,
        nativescript_mapbox_1.Mapbox])
], NSMapComponent);
exports.NSMapComponent = NSMapComponent;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vYmlsZS9tYXAvY29tcG9uZW50cy9tYXAvY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPO0FBQ1Asc0NBQWtGO0FBRWxGLDBDQUF5RDtBQU16RCxNQUFNO0FBQ04sMkVBQStGO0FBQy9GLDREQUE0RDtBQUU1RCwyREFBdUQ7QUFFdkQ7SUFDSSxvQkFBbUIsRUFBVSxFQUFTLFVBQWtCLEVBQVMsTUFBd0I7UUFBdEUsT0FBRSxHQUFGLEVBQUUsQ0FBUTtRQUFTLGVBQVUsR0FBVixVQUFVLENBQVE7UUFBUyxXQUFNLEdBQU4sTUFBTSxDQUFrQjtJQUFJLENBQUM7SUFDbEcsaUJBQUM7QUFBRCxDQUZBLEFBRUMsSUFBQTtBQVVELElBQWEsY0FBYztJQTZCdkIsd0JBQ1ksVUFBdUMsRUFDdkMsS0FBcUIsRUFDckIsTUFBYyxFQUNkLEdBQVc7UUFIWCxlQUFVLEdBQVYsVUFBVSxDQUE2QjtRQUN2QyxVQUFLLEdBQUwsS0FBSyxDQUFnQjtRQUNyQixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQ2QsUUFBRyxHQUFILEdBQUcsQ0FBUTtRQWhDaEIsWUFBTyxHQUFZLEtBQUssQ0FBQztRQUN6QixhQUFRLEdBQVEsRUFBRSxDQUFDO1FBSWxCLFlBQU8sR0FBYztZQUN6QixXQUFXLEVBQUUsY0FBTSxDQUFDLFdBQVcsRUFBRSxDQUFDLGVBQWU7WUFDakQsR0FBRyxFQUFFLElBQUk7WUFDVCxPQUFPLEVBQUU7Z0JBQ0wsU0FBUyxFQUFFLEtBQUs7Z0JBQ2hCLEtBQUssRUFBRSxpQ0FBaUM7Z0JBQ3hDLE1BQU0sRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDLFNBQVMsQ0FBQztnQkFDaEMsSUFBSSxFQUFFLENBQUM7Z0JBQ1AsSUFBSSxFQUFFLEtBQUs7Z0JBQ1gsV0FBVyxFQUFFLEtBQUs7YUFDckI7U0FDSixDQUFDO1FBQ00sV0FBTSxHQUFZO1lBQ3RCLEVBQUUsRUFBRSxRQUFRO1lBQ1osTUFBTSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVB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ZUFBZSxDQUFDLFFBQVE7UUFDNUMsU0FBUyxFQUFFLENBQUMsY0FBTSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUM7UUFDdkMsZUFBZSxFQUFFLDhCQUF1QixDQUFDLE1BQU07UUFDL0MsU0FBUyxFQUFFLENBQUMsNEJBQU0sQ0FBQztLQUN0QixDQUFDO3FDQStCMEIsb0NBQTJCO1FBQ2hDLHVCQUFjO1FBQ2IsZUFBTTtRQUNULDRCQUFNO0dBakNkLGNBQWMsQ0EySDFCO0FBM0hZLHdDQUFjIiwiZmlsZSI6Im1vYmlsZS9tYXAvY29tcG9uZW50cy9tYXAvY29tcG9uZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gbGlic1xyXG5pbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIENoYW5nZURldGVjdGlvblN0cmF0ZWd5IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5pbXBvcnQgeyBSb3V0ZXIsIEFjdGl2YXRlZFJvdXRlIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcclxuXHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzL09ic2VydmFibGUnO1xyXG5cclxuaW1wb3J0IHsgaXNBbmRyb2lkLCBpc0lPUyB9IGZyb20gJ3BsYXRmb3JtJztcclxuXHJcbi8vIGFwcFxyXG5pbXBvcnQgeyBBcGlTZXJ2aWNlUGFyYW1ldGVyc09wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi9hcHAvbW9kdWxlcy9jb3JlL3NlcnZpY2VzL2FwaS9tb2RlbHMnO1xyXG5pbXBvcnQgeyBDb25maWcgfSBmcm9tICcuLi8uLi8uLi8uLi9hcHAvbW9kdWxlcy9jb3JlL2luZGV4JztcclxuaW1wb3J0IHsgSUNvb3JkaW5hdGVzLCBJTWFwUXVlcnksIElNYXBGZWF0dXJlcywgSU1hcFNldHVwLCBJTWFwT3B0aW9ucywgSU1hcmtlciwgSVBvcHVwIH0gZnJvbSAnLi4vLi4vLi4vLi4vYXBwL21vZHVsZXMvbWFwL2ludGVyZmFjZXMvaW50ZXJmYWNlcyc7XHJcbmltcG9ydCB7IE1hcGJveCwgTWFwU3R5bGUgfSBmcm9tICduYXRpdmVzY3JpcHQtbWFwYm94JztcblxyXG5jbGFzcyBNYXBGZWF0dXJlIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBpZDogc3RyaW5nLCBwdWJsaWMgcGxhY2VfbmFtZTogc3RyaW5nLCBwdWJsaWMgY2VudGVyOiBbbnVtYmVyLCBudW1iZXJdKSB7IH1cclxufVxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBtb2R1bGVJZDogbW9kdWxlLmlkLFxyXG4gICAgc2VsZWN0b3I6ICdzZC1tYXAnLFxyXG4gICAgdGVtcGxhdGVVcmw6IENvbmZpZy5DT01QT05FTlRfSVRFTVMuVEVNUExBVEUsXHJcbiAgICBzdHlsZVVybHM6IFtDb25maWcuQ09NUE9ORU5UX0lURU1TLkNTU10sXHJcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxuICAgIHByb3ZpZGVyczogW01hcGJveF1cclxufSlcclxuZXhwb3J0IGNsYXNzIE5TTWFwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICAgIHB1YmxpYyBsb2FkaW5nOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwdWJsaWMgZmVhdHVyZXM6IGFueSA9IFtdO1xyXG5cclxuICAgIHByaXZhdGUgZXJyb3JNZXNzYWdlOiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIHJldHVyblVybDogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSBvcHRpb25zOiBJTWFwU2V0dXAgPSB7XHJcbiAgICAgICAgYWNjZXNzVG9rZW46IENvbmZpZy5FTlZJUk9OTUVOVCgpLk1BUF9CT1hfQVBJX0tFWSxcclxuICAgICAgICBtYXA6IG51bGwsXHJcbiAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICBjb250YWluZXI6ICdtYXAnLFxyXG4gICAgICAgICAgICBzdHlsZTogJ21hcGJveDovL3N0eWxlcy9tYXBib3gvbGlnaHQtdjknLFxyXG4gICAgICAgICAgICBjZW50ZXI6IFsxNTIuOTk0MzA2LCAtMjYuNjEyMjczXSxcclxuICAgICAgICAgICAgem9vbTogMSxcclxuICAgICAgICAgICAgaGFzaDogZmFsc2UsXHJcbiAgICAgICAgICAgIGludGVyYWN0aXZlOiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBwcml2YXRlIG1hcmtlcjogSU1hcmtlciA9IHtcclxuICAgICAgICBpZDogJ21hcmtlcicsXHJcbiAgICAgICAgb2Zmc2V0OiBbLTI1LCAtMjVdLFxyXG4gICAgICAgIGxhdExhbmc6IFswLCAwXSxcclxuICAgICAgICBwb3B1cDoge1xyXG4gICAgICAgICAgICBvZmZzZXQ6IDI1LFxyXG4gICAgICAgICAgICB0ZXh0OiAnJ1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBwcml2YXRlIG1hcmtlcnM6IElNYXJrZXJbXSA9IFtdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgYXBpT3B0aW9uczogQXBpU2VydmljZVBhcmFtZXRlcnNPcHRpb25zLFxyXG4gICAgICAgIHByaXZhdGUgcm91dGU6IEFjdGl2YXRlZFJvdXRlLFxyXG4gICAgICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXHJcbiAgICAgICAgcHJpdmF0ZSBtYXA6IE1hcGJveCkgeyB9XHJcblxyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5yZXR1cm5VcmwgPSB0aGlzLnJvdXRlLnNuYXBzaG90LnF1ZXJ5UGFyYW1zW0NvbmZpZy5ST1VURV9QQVJBTUVURVJTLkxPR0lOX1JFVFVSTl9VUkxdIHx8ICcvJztcclxuICAgICAgICB0aGlzLm9wdGlvbnMub3B0aW9ucy5jZW50ZXIgPSBbQ29uZmlnLlJPVVRFX1BBUkFNRVRFUlMuTE9OR0lUVURFLCBDb25maWcuUk9VVEVfUEFSQU1FVEVSUy5MQVRJVFVERV07XG4gICAgICAgIHRoaXMub25TaG93KHRoaXMub3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TaG93KG9wdGlvbnM6IElNYXBTZXR1cCkge1xyXG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgdGhpcy5tYXAuc2hvdyh7XHJcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBvcHRpb25zLmFjY2Vzc1Rva2VuLCAvLyBzZWUgJ1ByZXJlcXVpc2l0ZXMnIGFib3ZlIFxyXG4gICAgICAgICAgICBzdHlsZTogTWFwU3R5bGUuREFSSywgLy8gc2VlIHRoZSBtYXBib3guTWFwU3R5bGUgZW51bSBmb3Igb3RoZXIgb3B0aW9ucywgZGVmYXVsdCBtYXBib3guTWFwU3R5bGUuU1RSRUVUUyBcbiAgICAgICAgICAgIG1hcmdpbnM6IHtcclxuICAgICAgICAgICAgICAgIGxlZnQ6IDEwLFxyXG4gICAgICAgICAgICAgICAgcmlnaHQ6IDEwLFxyXG4gICAgICAgICAgICAgICAgdG9wOiA2NSxcclxuICAgICAgICAgICAgICAgIGJvdHRvbTogMFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjZW50ZXI6IHsgLy8gb3B0aW9uYWwgd2l0aG91dCBhIGRlZmF1bHQgXHJcbiAgICAgICAgICAgICAgICBsYXQ6IHNlbGYub3B0aW9ucy5vcHRpb25zLmNlbnRlclsxXSxcclxuICAgICAgICAgICAgICAgIGxuZzogc2VsZi5vcHRpb25zLm9wdGlvbnMuY2VudGVyWzBdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHpvb21MZXZlbDogMTMsIC8vIDAtMjAsIGRlZmF1bHQgMCBcclxuICAgICAgICAgICAgc2hvd1VzZXJMb2NhdGlvbjogdHJ1ZSwgLy8gZGVmYXVsdCBmYWxzZSAtIHJlcXVpcmVzIGxvY2F0aW9uIHBlcm1pc3Npb25zIG9uIEFuZHJvaWQgd2hpY2ggeW91IGNhbiByZW1vdmUgZnJvbSBBbmRyb2lkTWFuaWZlc3QueG1sIGlmIHlvdSBkb24ndCBuZWVkIHRoZW0gXHJcbiAgICAgICAgICAgIGhpZGVBdHRyaWJ1dGlvbjogZmFsc2UsIC8vIGRlZmF1bHQgdHJ1ZSwgTWFwYm94IHJlcXVpcmVzIGBmYWxzZWAgaWYgeW91J3JlIG9uIGEgZnJlZSBwbGFuIFxyXG4gICAgICAgICAgICBoaWRlTG9nbzogZmFsc2UsIC8vIGRlZmF1bHQgZmFsc2UsIE1hcGJveCByZXF1aXJlcyB0aGlzIGRlZmF1bHQgaWYgeW91J3JlIG9uIGEgZnJlZSBwbGFuIFxyXG4gICAgICAgICAgICBoaWRlQ29tcGFzczogdHJ1ZSwgLy8gZGVmYXVsdCBmYWxzZSBcclxuICAgICAgICAgICAgZGlzYWJsZVJvdGF0aW9uOiBmYWxzZSwgLy8gZGVmYXVsdCBmYWxzZSBcclxuICAgICAgICAgICAgZGlzYWJsZVNjcm9sbDogdHJ1ZSwgLy8gZGVmYXVsdCBmYWxzZSBcclxuICAgICAgICAgICAgZGlzYWJsZVpvb206IHRydWUsXHJcbiAgICAgICAgfSkudGhlbihcclxuICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5vbk1hcENvbXBvbmVudEluaXQoc2VsZi5vcHRpb25zKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1hcGJveCBzaG93IGVycm9yOiBcIiArIGVycm9yKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25NYXBDb21wb25lbnRJbml0KG9wdGlvbnM6IElNYXBTZXR1cCkge1xyXG4gICAgICAgIHRoaXMub25TZXRDZW50cmUob3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TZXRDZW50cmUob3B0aW9uczogSU1hcFNldHVwKSB7XHJcbiAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5tYXAuc2V0Q2VudGVyKHtcclxuICAgICAgICAgICAgbGF0OiBvcHRpb25zLm9wdGlvbnMuY2VudGVyWzFdLFxyXG4gICAgICAgICAgICBsbmc6IG9wdGlvbnMub3B0aW9ucy5jZW50ZXJbMF0sXHJcbiAgICAgICAgICAgIGFuaW1hdGVkOiBmYWxzZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLm9uUmVtb3ZlTWFya2VyKCk7XHJcblxyXG4gICAgICAgIHRoaXMubWFya2VyLmxhdExhbmcgPSB0aGlzLm9wdGlvbnMub3B0aW9ucy5jZW50ZXI7XHJcbiAgICAgICAgdGhpcy5tYXJrZXIucG9wdXAudGV4dCA9ICd0ZXN0aW5nJztcclxuICAgICAgICB0aGlzLm9uQWRkTWFya2Vycyh0aGlzLm1hcmtlcik7XHJcbiAgICB9XHJcblxyXG4gICAgb25SZW1vdmVNYXJrZXIoKSB7XHJcbiAgICAgICAgdGhpcy5tYXAucmVtb3ZlTWFya2VycygpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQWRkTWFya2VycyhtYXJrZXI6IElNYXJrZXIpIHtcclxuICAgICAgICB0aGlzLm1hcC5hZGRNYXJrZXJzKFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWQ6IG1hcmtlci5pZCwgLy8gY2FuIGJlIHVzZXIgaW4gJ3JlbW92ZU1hcmtlcnMoKSdcclxuICAgICAgICAgICAgICAgIGxhdDogbWFya2VyLmxhdExhbmdbMV0sIC8vIG1hbmRhdG9yeVxyXG4gICAgICAgICAgICAgICAgbG5nOiBtYXJrZXIubGF0TGFuZ1swXSwgLy8gbWFuZGF0b3J5XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogbWFya2VyLnBvcHVwLnRleHQsIC8vIG5vIHBvcHVwIHVubGVzcyBzZXRcclxuICAgICAgICAgICAgICAgIHN1YnRpdGxlOiAnSW5mYW1vdXMgc3VidGl0bGUhJyxcclxuICAgICAgICAgICAgICAgIGljb246ICdyZXM6Ly9tYXJrZXIyNV8yOScsIC8vIHByZWZlcnJlZCB3YXksIG90aGVyd2lzZSB1c2U6XHJcbiAgICAgICAgICAgICAgICAvL2ljb246ICdodHRwczovL2Zhcm05LnN0YXRpY2ZsaWNrci5jb20vODU3MS8xNTg0NDAxMDc1N182M2IwOTNkNTI3X24uanBnJywgLy8gZnJvbSB0aGUgaW50ZXJuZXQgKHNlZSB0aGUgbm90ZSBhdCB0aGUgYm90dG9tIG9mIHRoaXMgcmVhZG1lKSwgb3I6XHJcbiAgICAgICAgICAgICAgICBpY29uUGF0aDogJ3JlczovL21hcmtlcjI1XzI5JyxcclxuICAgICAgICAgICAgICAgIG9uVGFwOiB0aGlzLm9uVGFwLFxyXG4gICAgICAgICAgICAgICAgb25DYWxsb3V0VGFwOiB0aGlzLm9uQ2FsbG91dFRhcFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXSlcclxuICAgICAgICB0aGlzLmxvYWRpbmcgPSAhdGhpcy5sb2FkaW5nO1xyXG4gICAgfVxyXG5cclxuICAgIG9uVGFwKG1hcmtlcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiTWFya2VyIHRhcHBlZCB3aXRoIHRpdGxlOiAnXCIgKyBtYXJrZXIudGl0bGUgKyBcIidcIik7XHJcbiAgICB9XHJcblxyXG4gICAgb25DYWxsb3V0VGFwKG1hcmtlcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiTWFya2VyIGNhbGxvdXQgdGFwcGVkIHdpdGggdGl0bGU6ICdcIiArIG1hcmtlci50aXRsZSArIFwiJ1wiKTtcclxuICAgIH1cclxufVxyXG4iXX0=
